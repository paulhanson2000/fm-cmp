/*************************************************************************
 SCOPA software:  March, 2016
 
 Contributors:
 * Andrew P Morris A.P.Morris@liverpool.ac.uk
 * Reedik Magi reedik.magi@ut.ee

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*************************************************************************/

#include "global.h"
#include "filter.h"
#include "tools.h"

global::global(void)
{
    version = "0.2";
    inputFile = "mrmega.in";
    outputRoot = "mrmega";
    mapFile = "";
    
    gc=false;
    gco=false;
    qt=false;
    stdnames=true;
    debugMode=false;
    noalleles=false;
    pcsOnly=false;
    threshold = 1;
    pcCount = 3;
    precalculatedPC=false;
}
    double global::CHI_3_P[1447] = {4.89208550430854e-11,2.99508009268849e-11,1.8333619685494e-11,1.12205996194871e-11,6.86616972898766e-12,4.20093577799347e-12,2.56988021885555e-12,1.5718721877927e-12,9.6130490028021e-13,5.87823072790691e-13,3.59397888002049e-13,2.19709895105575e-13,1.3429833191224e-13,8.20805294514446e-14,5.01602576889625e-14,3.0650031758034e-14,1.87264335980146e-14,1.14401982924566e-14,6.9882375177422e-15,4.26833633549231e-15,2.60679975502258e-15,1.59190048026206e-15,9.72040716005272e-16,5.93491294431873e-16,3.62331935544467e-16,2.21188331170715e-16,1.3501501900378e-16,8.2407572919045e-17,5.02942345305432e-17,3.06927748617241e-17,1.87293101101949e-17,1.14281480478811e-17,6.97267034698782e-18,4.25394947586759e-18,2.59511218522427e-18,1.5830376120813e-18,9.65602245197344e-19,5.88949238319082e-19,3.59195289748288e-19,2.19057011928531e-19,1.33585097355116e-19,8.14579991744298e-20,4.96689378490097e-20,3.02839088214371e-20,1.84635585945652e-20,1.12563034907579e-20,6.86204487882626e-21,4.18301232667996e-21,2.54978173807159e-21,1.5541594313896e-21,9.47255741095609e-22,5.7732244684449e-22,3.51843516785412e-22,2.14417858980203e-22,1.30663118903676e-22,7.96207215421926e-23,4.85155065789665e-23,2.95608382742807e-23,1.80108813412147e-23,1.09732570175101e-23,6.68526794302804e-24,4.0727248544114e-24,2.48104480215758e-24,1.5113592738231e-24,9.20629058159032e-25,5.60771291164358e-25,3.41563348579527e-25,2.0803739762145e-25,1.26705794382426e-25,7.71679035563419e-26,4.69961554921056e-26,2.86202618760946e-26,1.74289308235184e-26,1.06133866497926e-26,6.46284206088874e-27,3.93531617887479e-27,2.39619667161246e-27,1.45898973465777e-27,8.88319423259836e-28,5.40845750613914e-28,3.29279897937938e-28,2.00467851035768e-28,1.22042797390454e-28,7.42963799670757e-29,4.52284192511497e-29,2.75323696365242e-29,1.67596277271143e-29,1.02017317819491e-29,6.20972477655888e-30,3.77972216290214e-30,2.3005762385823e-30,1.40024090445512e-30,8.52233134753564e-31,5.18685060783291e-31,3.15674043742227e-31,1.92116185758123e-31,1.16917392539759e-31,7.11515725655658e-32,4.32992357856702e-32,2.63491392848805e-32,1.60340500114252e-32,9.75687533006318e-33,5.93702829974682e-33,3.61258805485089e-33,2.19815766243784e-33,1.33748963270418e-33,8.13791799482618e-34,4.95139532768217e-34,3.01254408781555e-34,1.83286653153683e-34,1.11511586433462e-34,6.7842364028865e-35,4.12737449275936e-35,2.51095425656332e-35,1.5275514404639e-35,9.29276809425918e-36,5.65309988326185e-36,3.43890844849076e-36,2.09192954562089e-36,1.2725242455267e-36,7.74065543959553e-37,4.70849538956749e-37,2.8640420442638e-37,1.74208578402512e-37,1.05962616295171e-37,6.44508836697578e-38,3.92010973879935e-38,2.38429942884127e-38,1.45016246964689e-38,8.81994543673704e-39,5.36424467411616e-39,3.26245682936556e-39,1.98415023773114e-39,1.20669631729121e-39,7.33863256005352e-40,4.46299179819331e-40,2.7141315226339e-40,1.65055351338318e-40,1.00374250044854e-40,6.10392324861289e-41,3.71184577537912e-41,2.25717354670568e-41,1.372569075226e-41,8.34637235828497e-42,5.07522907058771e-42,3.0860854399275e-42,1.87652650251774e-42,1.14102714131512e-42,6.93796042149109e-43,4.21854110719207e-43,2.56500035906813e-43,1.55957873478258e-43,9.48248055448485e-44,5.76542661782096e-44,3.50538576773594e-44,2.13125355512027e-44,1.29577442120565e-44,7.87804963268748e-45,4.78964248959891e-45,2.91194122573623e-45,1.77034243676811e-45,1.07628470341563e-45,6.54323191819676e-46,3.97788992399206e-46,2.41829096774666e-46,1.47014352125136e-46,8.93730018304136e-47,5.43310912092427e-47,3.30282849760096e-47,2.00779409217161e-47,1.22052847017511e-47,7.41945985589936e-48,4.5101640214307e-48,2.74162526199902e-48,1.66655479735195e-48,1.01304068719281e-48,6.15786269693418e-49,3.74307882092428e-49,2.2752223146404e-49,1.3829759717331e-49,8.40623246650335e-50,5.10956768818656e-50,3.10572466764575e-50,1.88772102862133e-50,1.14738396643595e-50,6.97390253211123e-51,4.2387630119109e-51,2.57631283188819e-51,1.56586489188746e-51,9.51713518322263e-52,5.78434890373147e-52,3.51559668466247e-52,2.13668235549112e-52,1.29860557527381e-52,7.8924342734916e-53,4.79668418134055e-53,2.91519590449733e-53,1.77170276370023e-53,1.07673915298148e-53,6.54375003096799e-54,3.97685244074023e-54,2.41684534228836e-54,1.46877366518422e-54,8.92601380823009e-55,5.42446508089625e-55,3.29649934173515e-55,2.00329914801383e-55,1.21740584314127e-55,7.39812636209101e-56,4.49577864383803e-56,2.7320266495043e-56,1.6602053271547e-56,1.00887081517456e-56,6.13064575553242e-57,3.72540777241436e-57,2.26380160833462e-57,1.37562445665762e-57,8.35907864878956e-58,5.07941802219865e-58,3.0865018573197e-58,1.87549622537831e-58,1.13962753108706e-58,6.92479271220483e-59,4.20772890528657e-59,2.55673592781273e-59,1.5535354465489e-59,9.43960125829064e-60,5.73565924798304e-60,3.4850600449104e-60,2.11755372423231e-60,1.28663653483185e-60,7.81762095602128e-61,4.74996759887069e-61,2.88605106588105e-61,1.75353613738096e-61,1.06542477876603e-61,6.47333745654094e-62,3.93306480037064e-62,2.38963391807252e-62,1.45187451337561e-62,8.82113040202939e-63,5.35940865599065e-63,3.25616940999884e-63,1.97831122529497e-63,1.20193161819485e-63,7.30234660270283e-64,4.43652241460334e-64,2.69538302101884e-64,1.63755495558992e-64,9.94875834632761e-65,6.04420936478646e-65,3.67204294256559e-65,2.23086686797088e-65,1.35530556397488e-65,8.23376503990091e-66,5.00215810016429e-66,3.03888362709481e-66,1.8461562292809e-66,1.12155498760523e-66,6.81350292681957e-67,4.13921601520128e-67,2.51456878459171e-67,1.52758978553734e-67,9.27999586911948e-68,5.63750117387375e-68,3.42470641044583e-68,2.08045295978162e-68,1.26383483163965e-68,7.67751404555414e-69,4.66389550309477e-69,2.83318483472768e-69,1.72107154433095e-69,1.04549237845891e-69,6.35098025118024e-70,3.85796790161305e-70,2.34355109605276e-70,1.4236008056804e-70,8.64768809655684e-71,5.25302920196554e-71,3.19093259958096e-71,1.93831107214772e-71,1.17740903439056e-71,7.15202962210123e-72,4.34439504977405e-72,2.63892709510337e-72,1.60296323707253e-72,9.73683546596287e-73,5.91439343044321e-73,3.59253254986868e-73,2.18217383990002e-73,1.32548898142975e-73,8.05120811451305e-74,4.89039736336189e-74,2.97047170560855e-74,1.80428391471411e-74,1.0959292828122e-74,6.65669091254167e-75,4.04326745251483e-75,2.45586661261667e-75,1.49167879967555e-75,9.06033190227223e-76,5.50314751353001e-76,3.34253888746066e-76,2.03020577910326e-76,1.23311033390376e-76,7.48966013973028e-77,4.54904874406325e-77,2.76297773239113e-77,1.67815667086637e-77,1.01926228849002e-77,6.19067138764503e-78,3.76000046632129e-78,2.28368609282062e-78,1.38702179517278e-78,8.42419755138291e-79,5.11649068324487e-79,3.10752212230132e-79,1.88735969167941e-79,1.14628744544281e-79,6.96194869458177e-80,4.22830719177928e-80,2.56803349718644e-80,1.55967203157042e-80,9.47249402776672e-81,5.75299318941888e-81,3.49399156153584e-81,2.12201438597197e-81,1.2887636675672e-81,7.82702535145392e-82,4.75355694530466e-82,2.88694940790871e-82,1.75330780084473e-82,1.06481873630918e-82,6.46683437880533e-83,3.92741084579918e-83,2.38517078860683e-83,1.44854231412831e-83,8.79713902404051e-84,5.3425709307394e-84,3.24457425506264e-84,1.97044231654584e-84,1.19665325795395e-84,7.26727392778225e-85,4.41340051827783e-85,2.68024051671647e-85,1.62769420251164e-85,9.88485935229243e-86,6.00297877662072e-86,3.64553913132945e-86,2.2138865931011e-86,1.34445921589257e-86,8.16466852343342e-87,4.95824693589286e-87,3.01103929246603e-87,1.82853541500002e-87,1.11042445698052e-87,6.74331358734774e-88,4.09502347778595e-88,2.48678445483371e-88,1.5101448509335e-88,9.17060080757688e-89,5.56898052418181e-89,3.38183443515084e-89,2.0536561212286e-89,1.2471016424148e-89,7.57311810034691e-90,4.59881950944227e-90,2.7926516350387e-90,1.69584412525013e-90,1.02980233834038e-90,6.25346317300175e-91,3.79739790044579e-91,2.30595276695294e-91,1.40027555258089e-91,8.5030632404202e-92,5.16340416405219e-92,3.13541944058062e-92,1.90394322171896e-92,1.1561419635564e-92,7.02048583551154e-93,4.26306551153089e-93,2.58866402036711e-93,1.57191194998676e-93,9.5450805119475e-94,5.79601944843167e-94,3.5194835125201e-94,2.13711013578136e-94,1.29769833172241e-94,7.87987751587009e-95,4.78480310144795e-95,2.90541091249141e-95,1.76420865893049e-95,1.07125098363584e-95,6.50476215770134e-96,3.94975827467303e-96,2.39832771900948e-96,1.45628190836643e-96,8.8426269682678e-97,5.36928036927583e-97,3.26024165865689e-97,1.97962276653284e-97,1.20202646282607e-97,7.29868405571414e-98,4.43173773048025e-98,2.69093057510663e-98,1.63391664041373e-98,9.92101858289753e-99,6.0239533455533e-99,3.65768170444937e-99,2.22090099419339e-99,1.34850161110302e-99,8.18790373079351e-100,4.97156334494016e-100,3.01864625541569e-100,1.83286495648949e-100,1.11287841051053e-100,6.75715646591113e-101,4.10278960229866e-101,2.49111360731322e-101,1.51253991039989e-101,9.18373148127447e-102,5.57609983353133e-102,3.38564125269184e-102,2.05565567899124e-102,1.24812720242647e-102,7.57820536735466e-103,4.60121939497092e-103,2.79369227364672e-103,1.69622417713643e-103,1.02988087418889e-103,6.2530197750399e-104,3.79657234953713e-104,2.30511518555975e-104,1.3995636681134e-104,8.4975116504118e-105,5.15929026036098e-105,3.13247232805815e-105,1.90188221106619e-105,1.15472637366116e-105,7.01089807114798e-106,4.25664394217342e-106,2.58440219658066e-106,1.56910493791505e-106,9.52671099397124e-107,5.78406425912228e-107,3.51173995433617e-107,2.13211542794786e-107,1.29448852382815e-107,7.85931739376503e-108,4.77167203191283e-108,2.89704660884538e-108,1.75889340490229e-108,1.0678806169792e-108,6.48343312385293e-109,3.93628485368637e-109,2.38983082169037e-109,1.45093165324088e-109,8.80898589282908e-110,5.3481556566209e-110,3.24699284400531e-110,1.97132303103197e-110,1.19683266822459e-110,7.26621513691702e-111,4.41145903527354e-111,2.67827664151732e-111,1.62602719246837e-111,9.87186858420126e-112,5.99335662360785e-112,3.63864823453876e-112,2.20906871019256e-112,1.34115069579978e-112,8.14226326481614e-113,4.94324243750771e-113,3.00108221418824e-113,1.82197784016527e-113,1.10613340010824e-113,6.71538850477077e-114,4.07693703026138e-114,2.47511904192186e-114,1.50264852323902e-114,9.1225858517675e-115,5.53831617052596e-115,3.36230239092251e-115,2.04124453550581e-115,1.23923178750389e-115,7.52331596564966e-116,4.56736067566135e-116,2.77281291038299e-116,1.68335255268807e-116,1.02194813253828e-116,6.20414426148176e-117,3.76646715398533e-117,2.28657656159571e-117,1.38815058163695e-117,8.42726562362408e-118,5.11606508332208e-118,3.10588030868987e-118,1.88552653879817e-118,1.14466885348545e-118,6.94906488589902e-119,4.2186369795736e-119,2.56104514189931e-119,1.55475371906412e-119,9.43854976827388e-120,5.7299157123011e-120,3.47848789939568e-120,2.11169923659438e-120,1.28195545288362e-120,7.78239218168234e-121,4.72446462240468e-121,2.86808093344343e-121,1.74112326413931e-121,1.05698044305448e-121,6.41658135354872e-122,3.89528985852539e-122,2.36469525546271e-122,1.43552217884443e-122,8.71452986872494e-123,5.29026406407759e-123,3.2115158670819e-123,1.94958479912816e-123,1.18351434586429e-123,7.18462762838247e-124,4.3614846135884e-124,2.64766948966518e-124,1.6072837162984e-124,9.75709803793657e-125,5.92308745276668e-125,3.59562983696985e-125,2.18273575686696e-125,1.32503304495389e-125,8.04362132189246e-126,4.88287815631776e-126,2.96414553845081e-126,1.7993785014842e-126,1.0923074630578e-126,6.63081095709191e-127,4.02520279922637e-127,2.44347703575199e-127,1.48329705978658e-127,9.00424680234383e-128,5.46595468926303e-128,3.31805857638954e-128,2.01419473685796e-128,1.2226953303877e-128,7.42223056326962e-129,4.50557290422276e-129,2.7350482759607e-129,1.66027247613221e-129,1.00784359216453e-129,6.11795545274344e-130,3.71380318757767e-130,2.25439941809601e-130,1.36849195741247e-130,8.30716896308728e-131,5.04270135881112e-131,3.06106721941546e-131,1.85815483063112e-131,1.12795129525058e-131,6.84696667608762e-132,4.1562867364733e-132,2.5229707207296e-132,1.53150473460391e-132,9.29659481227919e-133,5.64324479491994e-133,3.42557362461102e-133,2.07939575924885e-133,1.26223562968743e-133,7.66201770567959e-134,4.65098891400825e-134,2.82323413393223e-134,1.7137518179813e-134,1.04027557860912e-134,6.31463601025655e-135,3.83307826162227e-135,2.32673272837297e-135,1.41235788997768e-135,8.57319048338802e-136,5.20402817108072e-136,3.15890277354804e-136,1.91748659176492e-136,1.16393270228982e-136,7.06517404642207e-137,4.28861757301526e-137,2.60322220395645e-137,1.58017295250638e-137,9.59174168390514e-138,5.82223583341349e-138,3.53412235613258e-138,2.1452249593074e-138,1.30215767296473e-138,7.90412468072644e-139,4.79781465372587e-139,2.91227665497071e-139,1.76775172975046e-139,1.07302389699511e-139,6.51323878303101e-140,3.9535213711573e-140,2.3997757882319e-140,1.45665509267914e-140,8.84183253169024e-141,5.36694727803585e-141,3.25770583297854e-141,1.97740621920095e-141,1.2002712991967e-141,7.28555169335539e-142,4.42226705026193e-142,2.68427487316517e-142,1.62932795376501e-142,9.88984611613952e-143,6.00302378543995e-143,3.64376282040228e-143,2.21171744587949e-143,1.34248269458293e-143,8.14867991831637e-144,4.94612780124464e-144,3.00222282119966e-144,1.82230062804357e-144,1.10610573494779e-144,6.71386773046218e-145,4.07519539664949e-145,2.47356663166539e-145,1.50140657104435e-145,9.11323426228035e-146,5.53154285117828e-146,3.35752731175787e-146,2.03794451035658e-146,1.23698571520585e-146,7.50821230543214e-147,4.55730333433197e-147,2.76616996291762e-147,1.67899468192666e-147,1.01910589984892e-147,6.18569992852259e-148,3.7545502343984e-148,2.27890662195778e-148,1.38323090155288e-148,8.39580566108429e-149,5.09600230811052e-149,3.09311737053207e-149,1.8774255778637e-149,1.13953746607307e-149,6.9166219093882e-150,4.19816026591506e-150,2.54814151437279e-150,1.54663425958455e-150,9.38752837899106e-151,5.69789517705583e-151,3.45841578411344e-151,2.09913085342031e-151,1.27409373079814e-151,7.73326345928836e-152,4.69379151251219e-152,2.84894685343216e-152,1.7291969636865e-152,1.04955244937536e-152,6.37035148873455e-153,3.8665373749289e-153,2.34682442082846e-153,1.4244216156831e-153,8.64561882009019e-154,5.2475089146511e-154,3.18500310675306e-154,1.93315247927955e-154,1.17333476232906e-154,7.12159615056442e-155,4.32247336136037e-155,2.62353515892535e-155,1.59235916938933e-155,9.66484202375862e-156,5.86608119220248e-156,3.560417806505e-156,2.16099342124311e-156,1.31161239443381e-156,7.96080832245237e-157,4.83179401639054e-157,2.93264332534036e-157,1.77995766227049e-157,1.08033809615221e-157,6.55706219672597e-158,3.97977491341744e-158,2.41550150764606e-158,1.46607339495034e-158,8.89823170561087e-159,5.40071559000387e-159,3.27792116447405e-159,1.98950622696263e-159,1.20751269009059e-159,7.32888163711688e-160,4.44818986829951e-160,2.69978096451015e-160,1.63860151442673e-160,9.94529753717118e-161,6.03617494112482e-161,3.66357819341705e-161,2.22355933741914e-161,1.34955812256625e-161,8.19094625563298e-162,4.9713709845598e-162,3.01729577811361e-162,1.83129880897786e-162,1.11147617503613e-162,6.74591276480851e-163,4.09431170321997e-163,2.48496745247074e-163,1.50820413771204e-163,9.1537526547688e-164,5.5556879101152e-164,3.37191123679077e-164,2.0465108473017e-164,1.24208579273065e-164,7.53856640192321e-165,4.5753630745263e-165,2.77691118736118e-165,1.68538082021945e-165,1.02290131130388e-165,6.20824797056347e-166,3.76794025483292e-166,2.28685481932407e-166,1.38794678579873e-166,8.42377333167932e-167,5.11258057521441e-167,3.10293941835676e-167,1.88324171660165e-167,1.14297958810194e-167,6.93698129850033e-168,4.21019502753339e-168,2.55525087960349e-168,1.55083117266403e-168,9.41228657343695e-169,5.71248938418394e-169,3.46701177193496e-169,2.10418961686844e-169,1.27706816198641e-169,7.75073575753454e-170,4.70404462931283e-170,2.85495709679128e-170,1.73271601784383e-170,1.05161033646907e-170,6.38236967065928e-171,3.87354600177369e-171,2.35090530194437e-171,1.42679378348816e-171,8.6593827850509e-172,5.25547923694578e-172,3.18960842295956e-172,1.93580707772566e-172,1.17486086386677e-172,7.13034365335171e-173,4.32747081438518e-173,2.62637959712057e-173,1.59397133688817e-173,9.6739354064909e-174,5.87118173800333e-174,3.56326014399918e-174,2.16256516528509e-174,1.31247349994232e-174,7.96547266966092e-175,4.83428476845308e-175,2.93394911079367e-175,1.78062552564028e-175,1.08066798173351e-175,6.55860757164174e-176,3.98043632507722e-176,2.41573554560831e-176,1.46611410866369e-176,8.89786540301551e-177,5.40012194448094e-177,3.277336081155e-177,1.98901505033201e-177,1.20713220887871e-177,7.32607374583177e-178,4.44618382398311e-178,2.69838070977799e-178,1.63764104389284e-178,9.93879854785871e-179,6.03182516107963e-179,3.66069280186382e-179,2.22165956497881e-179,1.34831517312146e-179,8.18285808316337e-180,4.96613251073547e-180,3.01391691445414e-180,1.82912732057792e-180,1.11008513381787e-180,6.73702760305799e-181,4.08865115163783e-181,2.48136973015301e-181,1.50592240478198e-181,9.13930986772803e-182,5.54656240486351e-182,3.3661549187906e-182,2.04288533270339e-182,1.23980555286373e-182,7.52424382545277e-183,4.5663778127396e-183,2.77128071787828e-183,1.68185634320649e-183,1.0206973199726e-183,6.19447852315067e-184,3.75934539971047e-184,2.28149440985174e-184,1.38460625990755e-184,8.40297120791097e-185,5.09963583025451e-185,3.09488956381981e-185,1.87823900086848e-185,1.1398724513865e-185,6.91769432130404e-186,4.1982295815665e-186,2.54783153760849e-186,1.54623301557224e-186,9.38380305671079e-187,5.69485323859557e-187,3.45609680753039e-187,2.09743722925574e-187,1.27289258841314e-187,7.72492471402866e-188,4.68809567751303e-188,2.84510560422857e-188,1.72663297280245e-188,1.04785546886013e-188,6.35919956473614e-189,3.85925291190221e-189,2.34209088454258e-189,1.42135959230249e-189,8.62588977053979e-190,5.23484180819879e-190,3.1768955774158e-190,1.92797784114267e-190,1.17004039831475e-190,7.10067111020053e-191,4.3092100091251e-191,2.61514422511365e-191,1.5870600290003e-191,9.63143030794061e-192,5.84504613947102e-192,3.54719306122668e-192,2.15268970864731e-192,1.30640480602178e-192,7.92818601694566e-193,4.81137958299763e-193,2.91988091095569e-193,1.77198640541743e-193,1.07536367446066e-193,6.52604506555072e-194,3.96044973453751e-194,2.40346982566377e-194,1.45858779285306e-194,8.85169023712523e-195,5.37179676712782e-195,3.25996301721587e-195,1.97836084127872e-195,1.20059927313435e-195,7.28602035855916e-196,4.4216302298076e-196,2.6833306894908e-196,1.62841731621078e-196,9.88227565468495e-197,5.99719201619905e-197,3.63947452132878e-197,2.20866145528558e-197,1.34035352515027e-197,8.13409631049382e-198,4.93627107470178e-198,2.99563180764126e-198,1.81793188964357e-198,1.10323117493074e-198,6.69507099396801e-199,4.06296977559295e-199,2.46565177616758e-199,1.4963033074402e-199,9.08044801094229e-200,5.51054639024563e-200,3.3441195605811e-200,2.02940476979012e-200,1.23155923520228e-200,7.47380361801989e-201,4.53552753553692e-201,2.75241352466532e-201,1.67031856615966e-201,1.01364220343977e-201,6.15134111840008e-202,3.73297163288086e-202,2.2653709151673e-202,1.37474992187511e-202,8.34272330864623e-203,5.06281117954625e-203,3.07238315200256e-203,1.8644844865303e-203,1.13146709564929e-203,6.86633264020081e-204,4.16684653525863e-204,2.52865703380606e-204,1.53451843451035e-204,9.31223760879648e-205,5.65113582776879e-205,3.42939256442409e-205,2.08112620253266e-205,1.26293032805029e-205,7.66408174390571e-206,4.65093879963854e-206,2.82241507292457e-206,1.71277731653686e-206,1.03939514752621e-206,6.307543149145e-207,3.8277145124116e-207,2.32283633683586e-207,1.40960505359689e-207,8.55413401212185e-208,5.19104049579335e-208,3.15015954414549e-208,1.9116591023162e-208,1.160080468965e-208,7.03988473543467e-209,4.27211317781335e-209,2.59250569449402e-209,1.57324535123834e-209,9.54713281886773e-210,5.79360979215899e-210,3.5158091226661e-210,2.1335415573701e-210,1.29472250030016e-210,7.85691502141453e-211,4.76790055297633e-211,2.89335747085618e-211,1.75580698148412e-211,1.06549452634295e-211,6.46584736585737e-212,3.92373300881841e-212,2.38107580811555e-212,1.44492988120621e-212,8.76839484212969e-213,5.32099927374539e-213,3.22898537525802e-213,1.95947051780962e-213,1.18908025192471e-213,7.21578155880543e-214,4.3788025961753e-214,2.65721769126056e-214,1.61249613703038e-214,9.78520684253842e-215,5.9380126437042e-215,3.6033961178793e-215,2.18666712533719e-215,1.32694562446922e-215,8.0523632790996e-216,4.88644905243259e-216,2.96526269067231e-216,1.79942087653137e-216,1.0919484093504e-216,6.6263026711291e-217,4.02105675817019e-217,2.44010728918551e-217,1.48073528904156e-217,8.98557176081459e-218,5.45272748843409e-218,3.30888487147761e-218,2.00793341486287e-218,1.2184753422504e-218,7.39407703381837e-219,4.48694747009255e-219,2.72281282936724e-219,1.65228279471916e-219,1.00265324223053e-219,6.08438846771861e-220,3.69218026788011e-220,2.24051909876002e-220,1.35960951394125e-220,8.25048599129619e-221,5.0066203427289e-221,3.03815257752128e-221,1.84363224111741e-221,1.1187648204463e-221,6.78895769475539e-222,4.11971523322225e-222,2.49994864246385e-222,1.51703210292823e-222,9.20573038013141e-223,5.58626490533299e-223,3.38988213355464e-223,2.0570624003126e-223,1.24827459278964e-223,7.57482481557185e-224,4.59658031879227e-224,2.78931081808712e-224,1.69261726974603e-224,1.027118195757e-224,6.23278114443564e-225,3.78218816791606e-225,2.29511359672175e-225,1.39272393833908e-225,8.45134237091647e-226,5.12845031243893e-226,3.11204888329987e-226,1.88845425899972e-226,1.14595175028664e-226,6.95386086811111e-227,4.21973778831324e-227,2.56061765971186e-227,1.55383110653899e-227,9.42893606061345e-228,5.72165113998382e-228,3.472001172847e-228,2.10687202770914e-228,1.27848682463359e-228,7.75807836995134e-229,4.70773354878697e-229,2.85673129956696e-229,1.73351146758484e-229,1.05192276098241e-229,6.38323441250902e-230,3.87344632900673e-230,2.35046668820906e-230,1.42629863749849e-230,8.65499145381227e-231,5.2519747449218e-231,3.18697329740252e-231,1.93390007682032e-231,1.17351716749449e-231,7.12106049182495e-232,4.32115370022374e-232,2.62213208670172e-232,1.59114305628791e-232,9.65525400129788e-233,5.85892571228949e-233,3.55526594410119e-233,2.15737681710985e-233,1.30912083906686e-233,7.94389104577931e-234,4.82043949744251e-234,2.9250938751321e-234,1.77497726962509e-234,1.0770741398559e-234,6.53579192692387e-235,3.96598121290439e-235,2.40659441322297e-235,1.46034333421514e-235,8.86149217574805e-236,5.37722936480054e-236,3.26294747478921e-236,1.97998282105224e-236,1.20146902889292e-236,7.29060479756855e-237,4.42399220548898e-237,2.68450964574771e-237,1.62897869493701e-237,9.88474932188239e-238,5.9981280961264e-238,3.63970037541185e-238,2.20859127316933e-238,1.34018542849318e-238,8.13231614079487e-239,4.9347304728176e-239,2.99441812934428e-239,1.8170265477005e-239,1.10257952889928e-239,6.6904973119768e-240,4.059819264097e-240,2.46351280210448e-240,1.49486774591577e-240,9.07090344288045e-241,5.50424988052554e-241,3.3399930616872e-241,2.02671561352337e-241,1.22981528888035e-241,7.46254200467909e-242,4.52828253459303e-242,2.74776805635895e-242,1.66734876406701e-242,1.01174871380556e-242,6.1392977648384e-243,3.72532839569823e-243,2.26052990173517e-243,1.37168938645774e-243,8.32340696218111e-244,5.05063879022358e-244,3.06472365208618e-244,1.85967117742695e-244,1.12844612726414e-244,6.84739420993454e-245,4.1549869391908e-245,2.52123789328278e-245,1.52988159537786e-245,9.28328419650879e-246,5.63307202348546e-246,3.41813171921618e-246,2.07411158568497e-246,1.25856390804929e-246,7.63692037221852e-247,4.63405394341624e-247,2.81192505423212e-247,1.70626401555244e-247,1.0353532630799e-247,6.28247423310096e-248,3.81217395999104e-248,2.31320722512221e-248,1.40364151687405e-248,8.51721688230638e-249,5.16819680589472e-249,3.13603005889586e-249,1.90292305048651e-249,1.15468114415135e-249,7.00652632586236e-250,4.25151073399378e-250,2.57978574963424e-250,1.56539462061255e-250,9.49869347277511e-251,5.76373158407097e-251,3.49738514517474e-251,2.12218389177439e-251,1.28772286113727e-251,7.81378824700433e-252,4.74133574224949e-252,2.87699840878255e-252,1.74573522215018e-252,1.05929511103614e-252,6.42769709556919e-253,3.90026107278246e-253,2.3666377962193e-253,1.43605064254625e-253,8.71379939020912e-254,5.28743694809187e-254,3.20835700976294e-254,1.94679408598306e-254,1.18129180567223e-254,7.16793746906749e-255,4.34941720855485e-255,2.63917247361255e-255,1.60141658400502e-255,9.71719045789094e-256,5.89626444504109e-256,3.57777509419926e-256,2.17094572099368e-256,1.31730014438639e-256,7.99319410807531e-257,4.85015732266342e-257,2.94300593937596e-257,1.78577318730893e-257,1.08358080755284e-257,6.57500606268834e-258,3.9896138096634e-258,2.42083621156363e-258,1.46892561306863e-258,8.9132081393313e-259,5.40839174594773e-259,3.28172422655343e-259,1.99129624097142e-259,1.20828536121066e-259,7.3316715915502e-260,4.44873301039525e-260,2.69941422128599e-260,1.63795728079751e-260,9.93883453939391e-261,6.03070661249968e-261,3.65932339648236e-261,2.22041030882166e-261,1.34730378237756e-261,8.17518660799847e-262,4.96054818246589e-262,3.00996553041336e-262,1.82638875428298e-262,1.10821692686986e-262,6.72444099397832e-263,4.08025633743735e-263,2.47581712349442e-263,1.50227531217166e-263,9.11549699190864e-264,5.53109385628938e-264,3.35615150922469e-264,2.03644152025658e-264,1.23566908934504e-264,7.49777282378936e-265,4.549484896139e-265,2.76052721540816e-265,1.67502654698871e-265,1.01636853538926e-265,6.16709424474647e-266,3.74205197521027e-266,2.27059094755162e-266,1.37774183440109e-266,8.35981461135746e-267,5.0725379489681e-267,3.07789514538963e-267,1.86759281463127e-267,1.13321007272465e-267,6.87604192907905e-268,4.17221293288441e-268,2.5315952514959e-268,1.53610866457647e-268,9.32072006040194e-269,5.65557608868438e-269,3.43165875095896e-269,2.08224198554062e-269,1.26345030337718e-269,7.66628550815808e-270,4.65169975170976e-270,2.82252775762808e-270,1.71263426671315e-270,1.03918028316701e-270,6.30546367924178e-271,3.82598286286014e-271,2.32150099614439e-271,1.40862240040992e-271,8.54712723075319e-272,5.18615640074235e-272,3.14681284004787e-272,1.90939631616663e-272,1.15856688315829e-272,7.02984911679711e-273,4.2655080003197e-273,2.58818539280975e-273,1.57043464241064e-273,9.52893174628235e-274,5.78187142888352e-274,3.50826595233747e-274,2.1287097639909e-274,1.29163635651169e-274,7.83725423024118e-275,4.75540461126066e-275,2.88543223993254e-275,1.75079037915925e-275,1.06232472385058e-275,6.44585145788361e-276,3.91113821648396e-276,2.37315388946496e-276,1.43995362660661e-276,8.73717386056625e-277,5.3014334880351e-277,3.21673677471782e-277,1.95181027041727e-277,1.1842940350258e-277,7.18590304237735e-278,4.36016608808172e-278,2.64560243240394e-278,1.60526227123517e-278,9.74018677646777e-279,5.91001306084769e-279,3.58599323465737e-279,2.17585705629194e-279,1.32023464672451e-279,8.01072384826185e-280,4.86062667496758e-280,2.9492571554042e-280,1.789504885074e-280,1.08580792149981e-280,6.58829435078997e-281,3.9975403320845e-281,2.4255631469779e-281,1.47174371069793e-281,8.93000420873686e-282,5.41839935198194e-282,3.28768522593797e-282,1.99484575965224e-282,1.21039824824357e-282,7.34424445318779e-283,4.45621190406012e-283,2.70386135236268e-283,1.64060063572177e-283,9.95454023765045e-284,6.04003438751088e-284,3.66486085248541e-284,2.22369614423617e-284,1.34925262135179e-284,8.18673952083845e-285,4.96739332581363e-285,3.01401910837049e-285,1.82878785289928e-285,1.10963598136797e-285,6.73282937873768e-286,4.08521165818611e-286,2.47874238095059e-286,1.50400090685804e-286,9.12566832677417e-287,5.53708434275514e-287,3.35967659742427e-287,2.03851394351596e-287,1.23688628980273e-287,7.50491438298224e-288,4.55367033037231e-288,2.76297724076038e-288,1.67645888501986e-288,1.01720476087546e-288,6.17196905040455e-289,3.74488920552698e-289,2.2722393979015e-289,1.37869778143192e-289,8.36534673323667e-290,5.07573214546515e-290,3.07973482400648e-290,1.86864942457931e-290,1.13381505341367e-290,6.87949383440236e-291,4.17417480867998e-291,2.53270530422486e-291,1.53673353042668e-291,9.32421663817205e-292,5.65751903674788e-292,3.43272943046858e-292,2.0828260653158e-292,1.26376497757141e-292,7.66795417490112e-293,4.65256643727262e-293,2.82296530007503e-293,1.71284623784506e-293,1.03927647917138e-293,6.30585094827371e-294,3.82609884988531e-294,2.32149928246166e-294,1.40857768582436e-294,8.54659132228557e-295,5.18567092934088e-295,3.14642115744772e-295,1.90909982107388e-295,1.15835133563507e-295,7.02832530252862e-296,4.26445257502359e-296,2.58746573759473e-296,1.56994996237284e-296,9.52569996540861e-297,5.77973425290834e-297,3.50686241381641e-297,2.12779345799826e-297,1.29104118390893e-297,7.83340550333714e-298,4.75292549637635e-298,2.88384085518814e-298,1.74977198731841e-298,1.0616748140743e-298,6.44171425478502e-299,3.90851050877268e-299,2.37148836466589e-299,1.43889995512872e-299,8.7305195000843e-300,5.29723770095551e-300,3.21409510246929e-300,1.95014934760676e-300,1.18325107724577e-300,7.17936167913727e-301,4.35606793786518e-301,2.64303761683656e-301,1.60365865354757e-301,9.73016955567662e-302,5.90376106830231e-302,3.58209439308098e-302,2.17342754984384e-302,1.31872183911241e-302,8.00131039478011e-303,4.85477299327757e-303,2.94561936101632e-303,1.78724550558296e-303,1.08440544902707e-303,6.57959343542255e-304,3.99214508273542e-304,2.42221931902392e-304,1.46967227542785e-304,8.91717787664913e-305,5.41046072561872e-305,3.28277379977165e-305,1.99180839868102e-305,1.20852058170794e-305,7.33264118988457e-306,4.44904407814055e-306,2.69943499942774e-306,1.6378681287493e-306,9.93767710547267e-307,6.02963083299595e-307,3.65844437975075e-307,2.2197398699162e-307,1.34681393471264e-307,8.17171124776188e-308,4.95813463960849e-308,3.00831640981072e-308,1.82527624822099e-308,1.10747411816647e-308,6.71952326366207e-309,4.07702365943555e-309,2.4737049337263e-309,1.50090240186858e-309,9.10661348157681e-310,5.52536852354813e-310,3.35247454491521e-310,2.03408746287801e-310,1.23416620963813e-310,7.48820240763622e-311,4.54340438771926e-311,2.75667207098503e-311,1.67258699061861e-311,1.01482747841711e-311,6.15737518431563e-312,3.73593155981277e-312,2.2667420532834e-312,1.37532452663137e-312,8.3446508519626e-313,5.0630363846003e-313,3.07194773818035e-313,1.86387375849621e-313,1.13088660886826e-313,6.86153883668171e-314,4.16316752324202e-314,2.52595811630489e-314,1.53259816198299e-314,9.29887378349666e-315,5.64198988074583e-315,3.42321479468912e-315,2.07699712888926e-315,1.26019437942091e-315,7.64608429358875e-316,4.63917246303742e-316,2.81476312981058e-316,1.70782392167921e-316,1.03620150750775e-316,6.28702585671282e-317,3.81457512149205e-317,2.31444607135251e-317,1.40426055222051e-317,8.52017194384521e-318,5.16950272490967e-318,3.13653128671503e-318,1.90304699530777e-318,1.15465117695683e-318,7.00565323177054e-319,4.250594970866e-319,2.57897326472672e-319,1.56475530694381e-319,9.49396545048539e-320,5.76031136486309e-320,3.49502037868098e-320,2.12052975195063e-320,1.28654694177061e-320,7.8062372042917e-321,4.73808954361755e-321,2.87546205879605e-321,1.7440517298196e-321,1.05730048210027e-321,6.4228533959362e-322,3.90311860214585e-322,2.37151510003798e-322,1.43279037293961e-322,8.89318162514244e-323,5.43472210425371e-323,2.96439387504748e-323,1.97626258336499e-323,9.88131291682493e-324,4.94065645841247e-324,4.94065645841247e-324,4.94065645841247e-324};


//global::~global(void)
//{
//}

void
global::createOutput()
{
	outputResult = outputRoot + ".result";
	outputLog = outputRoot + ".log";
}

bool
global::pushStandards()
{
    name_markerList.push_back("MARKERNAME");
    name_eaList.push_back("EA");
    name_neaList.push_back("NEA");
    name_eafList.push_back("EAF");
    name_betaList.push_back("BETA");
    name_seList.push_back("SE");
    name_orList.push_back("OR");
    name_or95lList.push_back("OR_95L");
    name_or95uList.push_back("OR_95U");
    name_strandList.push_back("STRAND");
    name_nList.push_back("N");
    name_chrList.push_back("CHROMOSOME");
    name_posList.push_back("POSITION");
    return true;
}

bool
global::parseFilters()
{
    if (filterList.size()>0)
    {
        for (int i = 0; i < filterList.size(); i++)
        {
            std::vector <std::string> tokens;
            if (debugMode) cout << "Parsing filter " << filterList[i] << endl;
            if (filterList[i].find("==") != std::string::npos)
            {
               int n = Tokenize(string(filterList[i]), tokens, "==");
                if (n==2)
                {
                    filters.push_back(filterD(uc(tokens[0]),"eq",atof(tokens[1].c_str())));
                }
                else
                {
                    cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\". Exit program."; exit(1);
                }
            }

            else if (filterList[i].find("!=") != std::string::npos)
            {
                int n = Tokenize(string(filterList[i]), tokens, "!=");
                if (n==2)
                {
                    filters.push_back(filterD(uc(tokens[0]),"ne",atof(tokens[1].c_str())));
                }
                else
                {
                    cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\" or even \"INFO\\>0.4\". Exit program."; exit(1);
                }
            }
            
            else if (filterList[i].find(">=") != std::string::npos)
            {
                int n = Tokenize(string(filterList[i]), tokens, ">=");
                if (n==2)
                {
                    filters.push_back(filterD(uc(tokens[0]),"ge",atof(tokens[1].c_str())));
                }
                else
                {
                    cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\". Exit program."; exit(1);
                }
            }
            
            else if (filterList[i].find("<=") != std::string::npos)
            {
                int n = Tokenize(string(filterList[i]), tokens, "<=");
                if (n==2)
                {
                    filters.push_back(filterD(uc(tokens[0]),"le",atof(tokens[1].c_str())));
                }
                else
                {
                    cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\". Exit program."; exit(1);
                }
            }
            
            else if (filterList[i].find(">") != std::string::npos)
            {
                int n = Tokenize(string(filterList[i]), tokens, ">");
                if (n==2)
                {
                    filters.push_back(filterD(uc(tokens[0]),"gt",atof(tokens[1].c_str())));
                }
                else
                {
                    cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\". Exit program."; exit(1);
                }
            }
            else if (filterList[i].find("<") != std::string::npos)
            {
                int n = Tokenize(string(filterList[i]), tokens, "<");
                if (n==2)
                {
                    filters.push_back(filterD(uc(tokens[0]),"lt",atof(tokens[1].c_str())));
                }
                else
                {
                    cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\". Exit program."; exit(1);
                }
            }
            
            else
            {
                cerr << "Non-valid filter \"" << filterList[i] << "\". Please make sure it is in format \"COLUMNNAMEequationVALUE\" e.g. \"INFO>0.4\". Exit program."; exit(1);
            }
        }
    }
    return true;
}

